<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Zone Hopping: A method to prevent zone-walking in DNSSEC</title>
<meta content="Fatema Bannat Wala" name="author">
<meta content="Stephan K Bohacek" name="author">
<meta content="Nick Buraglio" name="author">
<meta content="
       DNS Security Extension (DNSSEC) as defined by   was developed to address significant security integrity flaws in DNS. Within certain circumstances, information leakage may be possible stemming from a known DNSSEC vulnerability that facilitates a process known as zone walking, which enables the efficient collection of all FQDNs from a given environment. This document describes the problem space as outlined in   and offers a potential solution, called Zone-Hopping, to aid in addressing the domain information leakage capable via Zone-walking while preserving the integrity of the records for which DNSSEC was originally introduced. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="DNSOp" name="keyword">
<meta content="Zone Walking" name="keyword">
<meta content="DNSSEC-NSEC" name="keyword">
<meta content="draft-fbw-dnsop-dnszonehop-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 69.5.1
    wcwidth 0.2.13
-->
<link href="draft-fbw-dnsop-dnszonehop.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Zone Hopping: A method to prevent zone-w</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wala, et al.</td>
<td class="center">Expires 18 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DNSOP Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fbw-dnsop-dnszonehop-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-17" class="published">17 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-18">18 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Wala</div>
<div class="org">Energy Sciences Network</div>
</div>
<div class="author">
      <div class="author-name">S. Bohacek</div>
<div class="org">University of Delaware</div>
</div>
<div class="author">
      <div class="author-name">N. Buraglio</div>
<div class="org">Energy Sciences Network</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Zone Hopping: A method to prevent zone-walking in DNSSEC</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">DNS Security Extension (DNSSEC) as defined by <span>[<a href="#RFC9364" class="cite xref">RFC9364</a>]</span> was developed to address significant security integrity flaws in DNS. Within certain circumstances, information leakage may be possible stemming from a known DNSSEC vulnerability that facilitates a process known as zone walking, which enables the efficient collection of all FQDNs from a given environment. This document describes the problem space as outlined in <span>[<a href="#IEEE-ZoneHopping" class="cite xref">IEEE-ZoneHopping</a>]</span> and offers a potential solution, called Zone-Hopping, to aid in addressing the domain information leakage capable via Zone-walking while preserving the integrity of the records for which DNSSEC was originally introduced.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://github.com/fatemabw/test-IETF-ID">https://github.com/fatemabw/test-IETF-ID</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-fbw-dnsop-dnszonehop/">https://datatracker.ietf.org/doc/draft-fbw-dnsop-dnszonehop/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        WG Working Group mailing list (<span><a href="mailto:WG@example.com">mailto:WG@example.com</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/dnsop/">https://datatracker.ietf.org/wg/dnsop/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/fatemabw/test-IETF-ID">https://github.com/fatemabw/test-IETF-ID</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-practical-considerations" class="internal xref">Practical Considerations:</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-zone-hopping-zh" class="internal xref">Zone Hopping (ZH)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-exmaple-of-zh" class="internal xref">Exmaple of ZH</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations-of-" class="internal xref">Security Considerations of ZH</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-ipv6-address-discovery" class="internal xref">IPv6 Address Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-zh-vssplit-view-dnssec" class="internal xref">ZH vs.Split-view DNSSEC</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">DNSSEC introduced the concept of authenticated denial of existence (referred as DoE from now on), where it proved that a negative response actually came from the authoritative server and not from an attacker. DNSSEC uses NSEC <span>[<a href="#RFC3845" class="cite xref">RFC3845</a>]</span> or NSEC3 <span>[<a href="#RFC5155" class="cite xref">RFC5155</a>]</span> records to provide authenticated DoE protection where the domains or the hashes of the domains that encapsulates the queried domain is returned. The need to offer authenticated DoE as part of DNSSEC protocol protection coverage, opened up the protocol to an information leak problem, called zone-walking, in which an adversary can intentionally query non-existent domains and enumerate the complete zone from the owner names disclosed by the NSEC records. There are many tools available to easily enumerate the contents of a signed-zone, the result of which is similar to the result of a zone transfer process, which interestingly is not allowed from external sources.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1"><span>[<a href="#RFC4470" class="cite xref">RFC4470</a>]</span> was introduced, in early 2006, to solve the zone walking problem. This RFC introduced the concept of ”Minimally Covering NSEC Records and DNSSEC Online Signing”, which describes a way to construct DNSSEC NSEC resource records that cover a smaller range of names. According to the RFC:<a href="#section-2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-2">
<pre>
Whenever an NSEC record is needed to prove the non-existence of a name, a new NSEC record is dynamically produced and signed.
The new NSEC record has an owner name lexically before the QNAME (queried name) but lexically following any existing name and a
”next name” lexically following the QNAME but before any existing name.
</pre><a href="#section-2-2" class="pilcrow">¶</a>
</div>
<p id="section-2-3">The new NSEC record hence generated would still cover the non-existent query, but with the fake previous-name and the next name, effectively preventing the disclosure of zone contents. There were two adaptations found that were based on <span>[<a href="#RFC4470" class="cite xref">RFC4470</a>]</span> - NSEC3 White lies and Black lies.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">As mentioned in RFC 4470 section 5, there are some security risks associated with the methods described above. First, in order to sign NSEC records on-the-fly, the private key needs to be available on the internet-accessible zone’s authoritative servers. Any unintended disclosure of the private key can compromise the whole zone. Second, generating signatures of NSEC records is computationally expensive and makes authoritative servers vulnerable to a denial of service (DoS) attacks. As mentioned, NSEC was added specifically to resolve denial of existence attacks and therefore ensure client’s requested domain is resolved. Ironically, these online signing approaches increase the computational load on the servers and therefore opens an avenue for DoS, which have the same impact as the attack that NSEC was designed to solve.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">This drives a need for a practically viable solution that would prevent zone-walking and doesn't expose the servers to DoS attacks or private key compromises. The technique described in this document deals with off-line signing of the records and at the same time provide DoE attack protection for important domains, without compromising on the integrity of the records. This solution is a hybrid approach that combines best of both worlds, i.e. negative responses are handled just like traditional DNS (except for the domains that require DoE protection and hence have corresponding NSEC records), as well as all the records in the zone are signed (have corresponding RRSIGs) to provide integrity of the records classic DNSSEC protection.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Zone Walking: Zone walking is a straightforward process that utilizes NSEC records. The zone walker generates a DNSSEC query for a random FQDN under the desired apex domain. Assuming that the FQDN does not exist, the DNSSEC server will reply with an NSEC record that includes the next existing FQDN and the preceding existing FQDN from the requested FQDN. Here, ”next” and ”preceding” are based on lexicographic order. Therefore, two existing domains have been found. The zone walker then queries for a string that is slightly after the just returned "next" FQDN from the NSEC record, continues following this process until the next existing FQDN is the apex domain (SOA), signaling that there is no next FQDN and that the end of a zone is reached.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">DNSSEC: <span>[<a href="#RFC9364" class="cite xref">RFC9364</a>]</span> DNSSEC ensures the integrity of DNS messages, specifically protecting against malicious or forged answers. This is achieved by adding digital signatures to each DNS record hosted by the authoritative DNS server. To this end, DNSSEC introduces some new record types: RRSIG (digital Resource Record SIGnature), DNSKEY (public key record), DS (Delegation Signer, to establish chain of trust), NSEC (Next Secure, proof of nonexistence), NSEC3 (Hashed Next Secure). The signatures use public key cryptography to provide verifiable DNS messages.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">NSEC3 White Lies: NSEC3 White Lies, was introduced in 2014 for prevention of zone walking specifically in NSEC3, where fake NSEC3 records are generated on-the-fly that surround the requested name, as described in RFC 4470. The new NSEC3 record will comprise of the hash of the QNAME minus one as owner name and the hash of the QNAME plus one as the next name and therefore existing records that span the NSEC3 hash of the requested QNAME are not disclosed. White lies also requires online-signing of the newly created fake NSEC3 records on the request basis.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Black Lies (BL): Black Lies (BL), described in an RFC Internet draft in 2016, is implemented by utilizing a different secure negative response ”NODATA” instead of ”NXDOMAIN”. When a client queries for a non-existence domain, an NSEC record is dynamically created where the owner name is the same as the QNAME, and the next name as the immediate lexicographic successor of the QNAME (which is generated on-the-fly and doesn’t match any existing domain names in the zone). The response message have RCODE NOERROR, as opposed to NXDOMAIN, since a record matching the QNAME is being returned (of type NSEC). This method requires online-signing, as oppose to the offline signing in NSEC and NSEC3 implementations. This approach provides protection against zone-walking while still providing integrity of FQDN to IP mapping. Consequently, this method is used by several DNS service providers such as Cloudflare and Amazon Route 53.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="practical-considerations">
<section id="section-4">
      <h2 id="name-practical-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-practical-considerations" class="section-name selfRef">Practical Considerations:</a>
      </h2>
<p id="section-4-1"><span>[<a href="#RFC5155" class="cite xref">RFC5155</a>]</span> NSEC3 record type was introduced in RFC 5155, that is implemented to prevent clear text retrieval of FQDNs, instead the hashed versions are returned. That wasn't found to be too useful, as most of the hashes suffer collision attacks and since most FQDNs strings are simple and predictable, it became easy to create rainbow tables and do offline cracking of the hashed domains.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"><span>[<a href="#RFC4470" class="cite xref">RFC4470</a>]</span> As described in introduction the initial method to prevent zone-walking was introduced in RFC 4470, which has two practical implementations - NSEC3 White lies and Black lies (see the definitions section for the explanation).<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zone-hopping-zh">
<section id="section-5">
      <h2 id="name-zone-hopping-zh">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-zone-hopping-zh" class="section-name selfRef">Zone Hopping (ZH)</a>
      </h2>
<p id="section-5-1">The objective of this solution is to disable zone walking for specific FQDNs, while still allowing zone walking to find FQDNs that we seek to protect from denial of existence attacks. It is important to note that FQDNs protected from zone walking are not protected from denial of existence attacks. On the other hand, since all signatures are generated offline, this approach does not increase the computational load on the DNS server. Additionally, this method is trivially implemented in BIND9 by simply modifying a configuration file.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The proposed solution modifies the NSEC records for instantiated names, which are pre-generated and signed in advance (off-line), but in a slightly different manner: public and sensitive records are separated in two files and each is signed separately with the same key, thus creating two zone-files. Then, the NSEC records from the sensitive zone file are deleted, and this modified file is merged back into the public zone file. This process yields a final zone file devoid of and NSEC records with sensitive data, effectively preventing their disclosure through zone walking while still serving any requests for the sensitive domains with complete authenticity. This solution offers best of both worlds: sensitive information is handled just like traditional DNS (i.e. like traditional NXDOMAIN negative answers as opposed to specific NSEC), but at the same time, digital signatures (RRSIG) are available to prove the authenticity of the records.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">An extreme case of ZH implementation would be just having one NSEC record for SOA pointing to the last available record in the zone, hence, hopping the complete zone and all the domains in between the first and last record. It will effectively prevent zone-walking, i.e. no domain in the zone has NSEC records except the zone apex.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exmaple-of-zh">
<section id="section-6">
      <h2 id="name-exmaple-of-zh">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-exmaple-of-zh" class="section-name selfRef">Exmaple of ZH</a>
      </h2>
<p id="section-6-1">To show how ZH is implemented, let's take an example zone called "gotpcap.com". We registered this domain and use it for testing. Mentioned below are the steps involved to implement ZH in BIND9.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">First, create a public zone-file with records and signed it using the Zone Signing Key (ZSK). The resulted signed zone is as follows. Note that the records in the zone files shown below are truncated for the better readability.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-3">
<pre>
; gotpcap.signed.db.public
; File written on Tue Mar 12 17:52:50 2024
; dnssec_signzone version 9.18.18
; NOT SHOWING SOA AS IT IS SAME IN ALL
a.gotpcap.com.
            604800  IN A    192.168.2.3
            604800  RRSIG   A 13 3 604800
            604800  NSEC    dns.gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
dns.gotpcap.com.
            604800  IN A    34.125.87.209
            604800  RRSIG   A 13 3 604800
            604800  NSEC    z.gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
z.gotpcap.com.
            604800  IN A    192.168.2.4
            604800  RRSIG   A 13 3 604800
            604800  NSEC    gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
</pre><a href="#section-6-3" class="pilcrow">¶</a>
</div>
<p id="section-6-4">Next, create a sensitive zone-file with all sensitive records, and again signed it with the same ZSK. The resulted signed zone is as follows.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-5">
<pre>
; gotpcap.signed.db.sensitive
; File written on Tue Mar 12 18:06:31 2024
; dnssec_signzone version 9.18.18
; NOT SHOWING SOA Record
b-sensitive.gotpcap.com.
            604800  IN A   10.10.0.1
            604800  RRSIG   A 13 3 604800
            604800  NSEC    c-sensitive.gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
c-sensitive.gotpcap.com.
            604800  IN A   10.10.0.2
            604800  RRSIG   A 13 3 604800
            604800  NSEC    gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
</pre><a href="#section-6-5" class="pilcrow">¶</a>
</div>
<p id="section-6-6">Then delete all NSEC records from the signed sensitive zone-file and combine the resulting zone-file with the signed public zone-file. The final signed zone is as follows.<a href="#section-6-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-7">
<pre>
; gotpcap.signed.db.final
; File written on Tue Mar 12 18:06:31 2024
; dnssec_signzone version 9.18.18
gotpcap.com.
            604800  IN SOA  gotpcap.com.
            604800  RRSIG   SOA 13 2 604800
            604800  NS      dns.gotpcap.com.
            604800  RRSIG   NS 13 2 604800
            604800  NSEC    a.gotpcap.com.
            604800  RRSIG   NSEC 13 2 604800
            604800  DNSKEY  257 3 13 xS9zESD
            604800  RRSIG   DNSKEY 13 2 604800
a.gotpcap.com.
            604800  IN A    192.168.2.3
            604800  RRSIG   A 13 3 604800
            604800  NSEC    dns.gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
dns.gotpcap.com.
            604800  IN A    34.125.87.209
            604800  RRSIG   A 13 3 604800
            604800  NSEC    z.gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
b-sensitive.gotpcap.com.
            604800  IN A    10.10.0.1
            604800  RRSIG   A 13 3 604800
c-sensitive.gotpcap.com.
            604800  IN A    10.10.0.2
            604800  RRSIG   A 13 3 604800
z.gotpcap.com.
            604800  IN A    192.168.2.4
            604800  RRSIG   A 13 3 604800
            604800  NSEC    gotpcap.com.
            604800  RRSIG   NSEC 13 3 604800
</pre><a href="#section-6-7" class="pilcrow">¶</a>
</div>
<p id="section-6-8">With this final zone-file, the sensitive FQDNs are not longer discovered via zone-walking, as no NSEC records are available for them, but they do have valid signatures in RRSIG records to validate the authenticity of the records. The queries for a non-existent domain between dns.gotpcap.com. and z.gotpcap.com. will get the same NSEC response of:<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">dns.gotpcap.com. 604800  NSEC    z.gotpcap.com.<a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10">However, querying the sensitive FQDNs will generate a valid response from the name-server.<a href="#section-6-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations-of-zh">
<section id="section-7">
      <h2 id="name-security-considerations-of-">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations-of-" class="section-name selfRef">Security Considerations of ZH</a>
      </h2>
<p id="section-7-1">The proposed method of ZH is susceptible to denial of existence attacks for sensitive FQDNs via record replay. However, one could argue that DoE attacks have same impact as denial of service (DoS) attacks. And in reality DoS attack is much more convenient than pulling off a successful DoE, as it doesn't require MiTM of the queries requested by the client to forge a spoofed response that could successfully deny the existence of a valid domain. Hence, we argue that there are far more better ways to DoS a DNS server than trying to DoS an individual resolver/client via a DoE attack.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Combining the solution described above with the other available solutions, we have the following spectrum of solutions that should satisfy most use-cases.
• DNSSEC-NSEC protects against denial of existence attacks, is not especially vulnerable to DoS attack, but is vulnerable to zone walking.
• BL protects against denial of existence attacks and zone walking, but is susceptible to DoS attacks, which have the same impact as denial of existence attacks.
• ZH allows zone walking only on public FQDNs and protects against denial of existence attacks on these public FQDNs. For sensitive FQDNs, zone walking is not possible and denial of existence is possible. Moreover, the ZH is not especially vulnerable to DoS attacks.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="ipv6-address-discovery">
<section id="section-7.1">
        <h3 id="name-ipv6-address-discovery">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-ipv6-address-discovery" class="section-name selfRef">IPv6 Address Discovery</a>
        </h3>
<p id="section-7.1-1">For IPv6 networks, zone-walking is a critical tool for reconnaissance. According to the Office of Management and Budget (OMB) memorandum M-21-07, issued in Nov. 2020, the Federal government plans to transition to IPv6 only networks by 2025. An important benefit of IPv6 is that network reconnaissance through scanning is infeasible since the address space is so large that scanning takes too long unless massive network traffic is generated, which is easily detected. For instance, the private address range is fc00::/7, allowing private addresses to be dispersed randomly within an address space of 2^121 addresses. However, zone walking provides effective way to find all named hosts. Therefore, disabling zone walking will disable a crucial tool employed in malicious IPv6 network reconnaissance.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zh-vssplit-view-dnssec">
<section id="section-7.2">
        <h3 id="name-zh-vssplit-view-dnssec">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-zh-vssplit-view-dnssec" class="section-name selfRef">ZH vs.Split-view DNSSEC</a>
        </h3>
<p id="section-7.2-1">Zone walking can expose FQDNs from a private network to the public Internet. This vulnerability can be mitigated by using the Split-View DNS architecture, where a private DNS server is used to protect internal domains from being leaked to the public Internet. While this architecture addresses some aspects of the risks associated with zone walking, it does not entirely eliminate them. Specifically, even with a split-view DNS architecture, an external attacker can quickly discover all publicly facing servers and, upon gaining access to the private network, the attacker can efficiently discover internal servers, which facilitates lateral movement within the network, and doesn't really fit into the zero-trust model which explains the blurring line between what is considered non-trusted (External) and trusted (internal) network.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IEEE-ZoneHopping">[IEEE-ZoneHopping]</dt>
        <dd>
<span class="refTitle">"Zone-Hopping: Sensitive Information Leakage Prevention for DNSSEC-NSEC"</span>, <span>n.d.</span>, <span>&lt;<a href="https://dsn2024uq.github.io/Proceedings/pdfs/DSN-S2024-3LLnxbOIgEGedw7VY2pz6a/957000a104/957000a104.pdf">https://dsn2024uq.github.io/Proceedings/pdfs/DSN-S2024-3LLnxbOIgEGedw7VY2pz6a/957000a104/957000a104.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3845">[RFC3845]</dt>
        <dd>
<span class="refAuthor">Schlyter, J., Ed.</span>, <span class="refTitle">"DNS Security (DNSSEC) NextSECure (NSEC) RDATA Format"</span>, <span class="seriesInfo">RFC 3845</span>, <span class="seriesInfo">DOI 10.17487/RFC3845</span>, <time datetime="2004-08" class="refDate">August 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3845">https://www.rfc-editor.org/rfc/rfc3845</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4470">[RFC4470]</dt>
        <dd>
<span class="refAuthor">Weiler, S.</span> and <span class="refAuthor">J. Ihren</span>, <span class="refTitle">"Minimally Covering NSEC Records and DNSSEC On-line Signing"</span>, <span class="seriesInfo">RFC 4470</span>, <span class="seriesInfo">DOI 10.17487/RFC4470</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4470">https://www.rfc-editor.org/rfc/rfc4470</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5155">[RFC5155]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Sisson, G.</span>, <span class="refAuthor">Arends, R.</span>, and <span class="refAuthor">D. Blacka</span>, <span class="refTitle">"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"</span>, <span class="seriesInfo">RFC 5155</span>, <span class="seriesInfo">DOI 10.17487/RFC5155</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5155">https://www.rfc-editor.org/rfc/rfc5155</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9364">[RFC9364]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9364">https://www.rfc-editor.org/rfc/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">We would like to acknowledge the contribution of Domain-Tools for providing access to their PDNS database for research purposes, to perform analysis on the real world data collected from their network sensors. We appreciate their help and prompt support.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Fatema Bannat Wala</span></div>
<div dir="auto" class="left"><span class="org">Energy Sciences Network</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fatemebw@es.net" class="email">fatemebw@es.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stephan K Bohacek</span></div>
<div dir="auto" class="left"><span class="org">University of Delaware</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bohacek@udel.edu" class="email">bohacek@udel.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nick Buraglio</span></div>
<div dir="auto" class="left"><span class="org">Energy Sciences Network</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:buraglio@forwardingplane.net" class="email">buraglio@forwardingplane.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
